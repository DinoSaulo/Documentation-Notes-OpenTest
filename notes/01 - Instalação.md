# 1 - [Instalação](https://getopentest.org/docs/installation.html)


## Pré-requisitos

- Para instalar o OpenTest é necessário ter o Node.js em versão 8 ou superior.
- Ter o Java versão 8 até a 14 instalada (Por algum motivo, ao tentar executar o OpenTest com o Java 16 tive alguns problemas)
    - [Clique aqui para baixar o Java versão 14](https://www.oracle.com/java/technologies/javase/jdk14-archive-downloads.html) (Será necessário ter ou fazer uma conta da Oracle)

## Início rápido (Quick start)

### 1 - Entrar na pasta do projeto

OBS: Na documentação é pedido para instalar o OpenTest diretamente no disco C, em `C:\opentest`. Mas a instalação pode ser feita em qualquer diretório.

```bash
cd meu_diretorio
```

### 2 - Instalar o OpenTest

Para instalar basta executar algum dos comandos abaixo:
```bash
npm install opentest
```
Ou
```bash
npm install opentest -g
```

Obs: Por algum motivo na minha máquina ao tentar instalar com o `-g` ocorre alguns erros.

### 3 - Inicializar o projeto do OpenTest

Para executar o OpenTest é necessários de alguns arquivos de configuração para o Servidor, para o Actor e outros. Através do comando abaixo os arquivos são criados:

```bash
opentest quick-start
```

As seguintes pastas serão criadas

```bash
C:\meu_diretorio
├── server
│   └── server.yaml
├── actor1
│   └── actor.yaml
└── test-repo
    ├── macros
    │   └── ...
    ├── scripts
    │   └── ...
    ├── templates
    │   └── ...
    └── tests
        └── ...
```

- **[server.yaml](../server/server.yaml)** : Arquivo que contem as configurações do servidor que será utilizado para executar o OpenTest. Nele podemos definir algumas configurações como porta de execução do servidor, tempode espera padrão e muitos outros.
    Aprofundarei nesse arquivo mais adiante.

- **[actor.yaml](../actor1/actor.yaml)** : Arquivo que contem as configurações do ator que executará os testes. Nele podemos definir algumas configurações como o browser que será utilizado, o caminho para os divers, configurações dos drivers, porta de execução do servidor e muitos outros.
    Aprofundarei nesse arquivo mais adiante.


- **[./test-repo/macros/](../test-repo/macros/)** : Pasta que armazena os comandos personalizados criados. Ao utilizar o comando `opentest quick-start` é criado o arquivo [`AssertRepoHasNonEmptyWiki.yaml`](../test-repo/macros/github/AssertRepoHasNonEmptyWiki.yaml) que contem alguns exemplos de comandos personalizados.

- **[./test-repo/templates/](../test-repo/templates/)** : Pasta que armazena templetes de testes (equivalente a uma suite de testes), que podem ser executados facilmente pelo OpenTest. Ao utilizar o comando `opentest quick-start` são criados os templetes [`GitHub tests.yaml`](../test-repo/templates/github/GitHub%20tests.yaml) e [`Quick start tests.yaml`](../test-repo/templates/other/Quick%20start%20tests.yaml), ambos contém um conjunto de testes que podem ser executados pelo OpenTest através de `Session -> Create Session From Template... -> Selecionar o templete`.

- **[./test-repo/tests/](../test-repo/tests/)** : Contém os testes que podem ser executados pelo OpenTest. Eles são divididos nas pastas `api`, `mobile`, `other` e `web`.  Ao utilizar o comando `opentest quick-start` são criados alguns testes de cada um dos ambientes que foram criadas as pastas. Os arquivos criados são:
    - [api/GitHub API test.yaml](../test-repo/tests/api/GitHub%20API%20test.yaml)
    - [mobile/Mobile app test.yaml](../test-repo/tests/api/Mobile%20app%20test.yaml)
    - [other/Using an external JavaScript file.yaml](../test-repo/tests/other/Using%20an%20external%20JavaScript%20file.yaml)
    - [web/Find the React repo on GitHub's website.yaml](../test-repo/tests/web/Find%20the%20React%20repo%20on%20GitHub's%20website.yaml)
    - [web/Verify GitHub repos have non-empty wiki.yaml](../test-repo/tests/web/Verify%20GitHub%20repos%20have%20non-empty%20wiki.yaml)

### 4 - Executando o OpenTest

Para executar o OpenTest será necessário executar o servidor e o actor através do terminal:

#### - Executar o Servidor

Para executar o servidor basta executar o seguinte comando no terminal:

```bash
cd C:\meu_diretorio\server
opentest server
```

Para simplificar a execução vocÊ pode adicionar a seguinte linha **dentro do objeto `scripts`** no arquivo `package.json`:

```json
"opentest:server": "cd server && opentest server",
```

Com a adição desse comando, para executar o servidor basta excutar o seguinte comando no terminal:

```bash
npm run opentest:server
```

#### - Executar o Actor

Para executar o actor basta executar o seguinte comando no terminal:
(Será necessário abrir um outro terminal (pois o utilizando anteriormente está executando o servidor)
```bash
cd C:\meu_diretorio\actor1
opentest actor
```

OBS: Caso no seu ambiente O Java não esteja instalado ou haja alguma versão não compatível instalada, será retornado um erro.


Para simplificar a execução vocÊ pode adicionar a seguinte linha **dentro do objeto `scripts`** no arquivo `package.json`:

```json
"opentest:actor":"cd actor1 && opentest actor"
```

Com a adição desse comando, para executar o servidor basta excutar o seguinte comando no terminal:

```bash
npm run opentest:actor
```

Com os Servidor e Actor sendo executados basta acessar o servidor local do Open Test para executar os testes: [http://localhost:3000/](http://localhost:3000/)


### 5 - Atualizando a versão do OpenTest

Ao executar o comando `npm install opentest -g` é instalada ultima versão do OpenTest.

Mas, se você quiser utilizar uma versão mais recente ou manis antiga, basta especificar a versão na instalação do OpenTest. Por exemplo, se você estiver executando o OpenTest 0.9.16 e estiver atualizando para 1.0.4, será necessário executar o comando:

```bash
npm install opentest@1.0.4 -g
```

Como alternativa, para atualizar para a versão mais recente disponível, basta executar o comando:

```bash
npm install opentest@latest -g
```
